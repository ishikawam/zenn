---
title: "法改正をマイクロサービスで立ち向かう"
emoji: "🙆"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["microservice"]
published: false
---
:::message
この記事は [LITALICO Engineers Advent Calendar 2021](https://qiita.com/advent-calendar/2021/litalico)の12/15配信になります。
:::

## 背景とか

LITALICOは障害福祉領域において複数の事業を展開していますが、コア事業として以下の２つがあります。

* 児童福祉法に基づく障害児支援事業
* 障害者総合支援法に基づく就労支援事業

領域は違うものの、その支援内容については各種法令に沿って行われるものとなっています。
今自身が携わっているプロダクトでは前者の障害児支援事業に携わっている事業所さま ^[LITALICO自身も含まれます] 向けの運営支援システムとなります。

運営支援システムはその支援内容にあわせて機能提供を行っており、 給付費の請求業務も含まれます。

給付費請求については馴染みがない人が多いと思いますので軽く補足します。
一番身近な医療をベースで説明すると、お医者さんに掛かった際の医療費は原則3割自己負担分として支払っていらっしゃると思います。
その際に受け取られる診療明細書に点数が書いてあると思いますが、その点数はお医者さんが勝手に決めたものではなく診療報酬制度というもので決めれたものになります。
また、3割支払いされた残りの費用を請求するレセプト業務がそれにあたります。

障害者福祉領域では自己負担が1割だったりしますが、医療と同じように支援内容に応じて点数が `障害福祉サービス等に係る報酬` として定められています。
この定められた点数のことを報酬単位と呼びます。

今回記事として取り上げるのは、この `障害福祉サービス等に係る報酬` が3年に1度大きな改定が行われるのですが、ちょうど今年が法改正のタイミングにあたりシステム改修にあたりどうやって立ち向かっていって乗り越えたか？をお話したいと思います。
ちなみにプロダクトとして大規模な法改正に対応したのは今回が初となります。

## 法改正への対応の難しさ

まず法律改正に伴いどう変更があるかのキャッチアップが大変ですw
今回の法改正の資料としては. [こちら](https://www.mhlw.go.jp/stf/seisakunitsuite/bunya/0000202214_00007.html) にまとめられていますが、資料の多くまた記載されている内容もドメイン知識がないと一筋縄ではいかなかったりします。
また今でこそ情報が集約されてたりQ&Aも整備されて掲載されていますが、法律施行前までは五月雨に情報がアップされて随時変更も加えられていく感じになっています。
システム的には如何に精度高く情報をキャッチアップして、素早く且つ正確にシステムへ反映していくか？が求められます。
日々の運営や請求業務があり、法改正の施行は待ってくれないエンドがずらせないプロジェクトとなります。

次に報酬制度自体が複雑で難解という点です。
一つ一つの支援内容に対して様々な条件の組み合わせによって報酬単位が定まるようになっています。加算だけでなく減算や割合加算もあったりします。
この報酬単位の組み合わせを表したものを報酬算定構造と呼びますが、組み合わせの数が膨大です。
この組み合わせの複雑さもあって請求業務周りの単体テストはNNNNケースほど必要になっています。
また、組み合わせとなるパラメータが法改正によって増減します。システム改修時に報酬算定構造を誤って設計（事前にキャッチアップした情報で行うので厳密には設計ではなく予想に近いですが :sweat_smile: ）を行うと大変なことになります。 ^[正確な情報が出揃ってからシステム改修していては間に合わないという側面があります]

次に、法改正がされても旧制度の対応は無くならない点が難しいです。
過去行った支援に対しての給付費の請求がもし間違っていた場合に、その時点での報酬制度に応じた再請求を行う必要がある為です。
これはロジックの肥大に直結します。元々扱うドメインが複雑で且つ品質の担保する為のテスト量が多くなっているのに、更に複雑度が上がるのは無理ゲーです。
旧制度のロジックの品質を担保したまま法改正に対応する必要があります。
システム改修を非常に短期間に行う必要があるのは上述の通りですが、新制度だけでも検証するのに手一杯な上、さらに旧制度の検証にどこまで労力を割けるかが課題となります。


## どう立ち向かったのか？

## 結果どうだったのか？

## まとめ
